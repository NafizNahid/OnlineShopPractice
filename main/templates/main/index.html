{% extends 'main/base.html' %}

{% load static %}

{% comment %} {% block css_link %} "{% static 'main/css/index.css' %}" {% endblock %} {% endcomment %}

{% block css %}
    .carousel-item img { 
        height: 300px;
    }
    .categories img {
        height: 200px;
    }
    .homepage-section img{
        height: 200px;
    }
{% endblock %}

{% block body %} 

    <section class="container">

        <!--######## Header contains the main slider and the offers slider ########-->
        <div class="header row justify-content-center">

            <!--##### Main carousel #####-->
            <div class="main-carousel col-md-8 my-3">
                <div id="MainCarousel" class="carousel slide carousel-fade" data-ride="carousel">
                    <div class="carousel-inner">
                        {% for img in main_images %}
                            {% if forloop.first %}
                                <div class="carousel-item active">
                            {% else %}
                                <div class="carousel-item">
                            {% endif %}
                                <img src='/media/{{img}}' class="d-block w-100" alt="...">
                            </div>
                        {% endfor %}
                    </div>
                    <button class="carousel-control-prev" type="button" data-target="#MainCarousel" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-target="#MainCarousel" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                    </button>
                </div>
            </div> <!--MainCarousel ends here-->

            <!--##### Offer carousel #####-->
            <div class="offer-carousel col-md-4 my-3">
                <div id="OfferCarousel" class="carousel slide carousel-fade" data-ride="carousel">
                    <div class="carousel-inner">
                        {% for img in offer_images %}
                            {% if forloop.first %}
                                <div class="carousel-item active">
                            {% else %}
                                <div class="carousel-item">
                            {% endif %}
                                <img src='/media/{{img}}' class="d-block w-100" alt="...">
                            </div>
                        {% endfor %}
                    </div>
                    <button class="carousel-control-prev" type="button" data-target="#OfferCarousel" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-target="#OfferCarousel" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                    </button>
                  </div>
            </div> <!--OfferCarousel ends here-->

        </div> <!--######## Header ends here ########-->

        <div class="categories my-3">
            <h5 class="text-center mb-3">Shop by category</h5>
            <div class="owl-carousel owl-theme">
                {% for category in categories %}
                <div class="item bg-dark">
                    <img src='/media/{{category.image}}' alt="">
                    <div class="d-flex justify-content-center p-2">
                        <a href="/main/categories/{{category.id}}" id="category_view{{category.id}}" class="btn btn-outline-info">{{category.name}}</a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        {% for category in dynamicProds %}
            <div class="homepage-section my-3">
                <h5 class="text-center mb-3">{{category.0.caption}}</h5>
                <div class="owl-carousel owl-theme">
                    {% for product in category %}
                    <div class="item bg-light">
                        <img src='/media/{{product.image}}' alt="">
                        <div class="d-flex justify-content-center">
                            <a href="/main/dynamic_products/{{product.id}}" id="dynamic_product_view{{product.id}}" class="text-info">{{product.name}}</a>
                        </div>
                        <div class="d-flex justify-content-around px-2">
                            <span id="div_pr{{product.id}}" class="div_pr">
                                <button id="pr{{product.id}}" class="btn btn-info cart">Add to cart</button>
                            </span>
                            <a href="/main/dynamic_products/{{product.id}}"><button id="view_pr{{product.id}}" class="btn btn-outline-info cart">View</button></a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}

    </section>

{% endblock %}

{% block js %}
    <script>

        $('#popcart').popover(); //shows the pop over for cart

        //function to run the categories owl-carousel
        (function ($) {
            $('.owl-carousel').owlCarousel({
                loop: true,
                margin: 20,
                nav: false,
                autoplay: true,
                autoplayTimeout: 3000,
                responsive:{
                    0:{
                        items:1
                    },
                    600:{
                        items:3
                    },
                    1000:{
                        items:5
                    }
                }
            }); 
        }(owl_carousel_version));
        
    </script>
{% endblock %}    

